<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">


<html>
<head>
  <title>Augeas &mdash; Tree</title>

  
  

  <meta name="keywords" content="configuration management">
  <meta name="description" content="Configuration API for Linux">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <link rel="shortcut icon" href="..//styles/favicon.ico" type="image/x-icon">

  <link rel="StyleSheet" type="text/css" href="../styles/default.css" title="Main style">
  <link rel="Alternate StyleSheet" type="text/css" href="../styles/default-debug.css" title="Debug main style">

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-18273001-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</head>

<body>

  <div id="header">
    <div id="headerLogo"></div>
  </div>

  <div id="body">
    <div id="menu">
      <ul class="l0">
         <li><div>
<a class='inactive' title='Main' href='../index.html'>Main</a>
<li><div>
<a class='inactive' title='FAQ' href='../faq.html'>FAQ</a>
</div></li>
<li><div>
<a class='inactive' title='Quick Tour' href='../tour.html'>Quick Tour</a>
</div></li>
<li><div>
<a class='active' title='Documentation' href='index.html'>Documentation</a>
<ul class='l1'>
<li>
<a class='inactive' title='Public API' href='api.html'>Public API</a>
</li>
<li>
<span class='active'>Tree</span>
</li>
<li>
<a class='inactive' title='Lenses' href='lenses.html'>Lenses</a>
</li>
<li>
<a class='inactive' title='Builtin functions' href='builtins.html'>Builtin functions</a>
</li>
<li>
<a class='inactive' title='Reference documentation' href='reference.html'>Reference documentation</a>
</li>
<li>
<a class='inactive' title='Language' href='language.html'>Language</a>
</li>
<li>
<a class='inactive' title='Schema tutorial' href='writing-schemas.html'>Schema tutorial</a>
</li>
</ul>
</div></li>
<li><div>
<a class='inactive' title='Download' href='../download.html'>Download</a>
</div></li>
<li><div>
<a class='inactive' title='Releases' href='../news.html'>Releases</a>
</div></li>
<li><div>
<a class='inactive' title='Stock Lenses' href='../stock_lenses.html'>Stock Lenses</a>
</div></li>
<li><div>
<a class='inactive' title='Wiki' href='https://github.com/hercules-team/augeas/wiki'>Wiki</a>
</div></li>
<li><div>
<a class='inactive' title='Bug tracker' href='https://github.com/hercules-team/augeas/issues'>Bug tracker</a>
</div></li>
<li><div>
<a class='inactive' title='Todo list' href='../todo.html'>Todo list</a>
</div></li>
<li><div>
<a class='inactive' title='Contribute' href='../developers.html'>Contribute</a>
</div></li>
<li><div>
<a class='inactive' title='libfa' href='../libfa/index.html'>libfa</a>
</div></li>

      </ul>
    </div>

    <div id="content">
      <div class="document" id="the-tree">
<h1 class="title">The tree</h1>
<p>The tree that Augeas maintains is very similar to the tree of files and
directories in a filesystem: the components of a path are strings that can,
and nodes have an optional value associated with them, which can be an
arbitrary string.</p>
<p>Augeas' tree deviates from the files-in-a-filesystem model in one important
way: multiple children in a tree can have the same label. For example, the
schema for <tt class="docutils literal">/etc/hosts</tt> uses that to map multiple aliases for the same
host to multiple nodes, all with the path <tt class="docutils literal">/files/etc/hosts/N/alias</tt>,
where <tt class="docutils literal">N</tt> is the number of the host entry in the file. All numbering in
Augeas starts with one, not zero.</p>
<p>With that, a tree node consists of three pieces of data:</p>
<dl class="docutils">
<dt>a <em>label</em></dt>
<dd>a string that is part of the path of the node. The string can contain any
characters except for <tt class="docutils literal">/</tt>, <tt class="docutils literal">*</tt>, or <tt class="docutils literal">[</tt>. Strictly speaking, nodes
can also have <tt class="docutils literal">NULL</tt> as a label, but such nodes are not accessible
through the public API — they are sometimes used by the lenses
processing the files to store important formatting information.</dd>
<dt>a <em>value</em></dt>
<dd>an arbitrary string or <tt class="docutils literal">NULL</tt></dd>
<dt>the <em>children</em></dt>
<dd>a list of tree nodes, where multiple children can have the same
label. Since files are inherently sequential, ordering in the list of
children matters.</dd>
</dl>
<p>The tree can be searched in all kinds of ways by using <a class="reference external" href="/page/Path_expressions">path expressions</a></p>
<div class="section" id="important-paths">
<h2>Important paths</h2>
<p>The Augeas tree consist of two separate hierarchies: <tt class="docutils literal">/augeas</tt> used for
reporting important metadata, in particular information about how files
were processed, and <tt class="docutils literal">/files</tt> containing the result of parsing
configuration files.</p>
<div class="section" id="configuration-data-in-files">
<h3>Configuration data in <tt class="docutils literal">/files</tt></h3>
<p>By convention, all configuration files get parsed into the <tt class="docutils literal">/files</tt>
hierarchy. The contents of a file that has the absolute path <tt class="docutils literal">/PATH</tt> in
the file system appears at <tt class="docutils literal">/files/PATH</tt> in the tree. For example, the
contents of <tt class="docutils literal">/etc/hosts</tt> appear at <tt class="docutils literal">/files/etc/hosts</tt>.</p>
</div>
<div class="section" id="metainformation-in-augeas">
<h3>Metainformation in <tt class="docutils literal">/augeas</tt></h3>
<p>The <tt class="docutils literal">/augeas</tt> hierarchy reports important metadata about Augeas' inner
workings. Most entries under <tt class="docutils literal">/augeas</tt> are readonly — it is possible
to change them by issuing <tt class="docutils literal">set</tt> commands, but those changes have no
influence on how Augeas goes about its business.</p>
<p>The entries <tt class="docutils literal">/augeas/root</tt> and <tt class="docutils literal">/augeas/save</tt> report the file system
root from which files are read, and how files are saved. The save modes,
corresponding to starting <tt class="docutils literal">augtool</tt> with the <tt class="docutils literal"><span class="pre">-n</span></tt>, the <tt class="docutils literal"><span class="pre">-b</span></tt>, or
neither of these options are <tt class="docutils literal">newfile</tt>, <tt class="docutils literal">backup</tt>, and
<tt class="docutils literal">overwrite</tt>. Changing <tt class="docutils literal">/augeas/save</tt> before saving the tree changes how
updated files are saved.</p>
<p>For each file <tt class="docutils literal">/PATH</tt> that was processed, some metadata is presented in
<tt class="docutils literal">/augeas/files/PATH</tt>. That information is due to be revised soon; the
entries mentioned here will remain, but other entries may be removed.</p>
<p>Underneath <tt class="docutils literal">/augeas/files/PATH</tt>, the entry <tt class="docutils literal">error</tt> has no value if
processing of the file was successful. Values that indicate errors are</p>
<dl class="docutils">
<dt><tt class="docutils literal">read_failed</tt></dt>
<dd>Reading the file failed; this means that the file exists, but can not be
read, for example, because of insufficient permissions</dd>
<dt><tt class="docutils literal">parse_failed</tt></dt>
<dd>Parsing the file into the tree failed. This usually means that the file
does not match the lens that was applied to it.</dd>
<dt><tt class="docutils literal">put_read</tt></dt>
<dd>Reading the file before saving changes of it failed, for similar reasons
as <tt class="docutils literal">read_failed</tt> indicates. Before Augeas writes a changed file, it
has to read the original file back in to extract comments etc.</dd>
<dt><tt class="docutils literal">rename_augsave</tt></dt>
<dd>Renaming the original file to one ending with <tt class="docutils literal">.augsave</tt> failed; this
can only happen when the save mode is <tt class="docutils literal">backup</tt></dd>
<dt><tt class="docutils literal">rename_augnew</tt></dt>
<dd>Renaming the new file with extension <tt class="docutils literal">.augnew</tt> to the original file
name failed; this can only happen when the save mode is <tt class="docutils literal">backup</tt></dd>
</dl>
<p>The entry <tt class="docutils literal">lens/info</tt> underneath <tt class="docutils literal">/augeas/files/PATH</tt> indicates the lens
that is used to process the file. The value contains the path to the
<tt class="docutils literal">.aug</tt> schema definition, and the line and column number where that lens
was defined. For example, <tt class="docutils literal">/augeas/files/etc/hosts/lens/info</tt> might
have the value <tt class="docutils literal"><span class="pre">/usr/share/augeas/lenses/hosts.aug:18.12-.34</span></tt>.</p>
<div class="section" id="features-under-augeas-version">
<h4>Features under <tt class="docutils literal">/augeas/version</tt></h4>
<p>The node <tt class="docutils literal">/augeas/version</tt> contains the version number of the Augeas
library. Underneath it are a few entries that indicate a few features of
the API:</p>
<dl class="docutils">
<dt><tt class="docutils literal">save</tt></dt>
<dd>The behavior of <tt class="docutils literal">aug_save</tt> can be changed dynamically at runtime by
changing the entry <tt class="docutils literal">/augeas/save</tt>. The possible values that can be
assigned to <tt class="docutils literal">/augeas/save</tt> are listed in <tt class="docutils literal">/augeas/version/save/mode</tt></dd>
<dt><tt class="docutils literal">defvar</tt></dt>
<dd>Variables can be defined for later use in path expressions</dd>
<dt><tt class="docutils literal">defvar/expr</tt></dt>
<dd>The expression used to define a variable <tt class="docutils literal">var</tt> is stored in
<tt class="docutils literal">/augeas/variables/var</tt></dd>
</dl>
</div>
</div>
</div>
</div>

    </div>
  </div>

  <div id="footer">
    <div id="projects">
      <dl id="p1">
        <dt><a href="http://augeas.net/">Augeas</a></dt>
        <dd><span>A configuration editing tool and API</span></dd>
        <dt><a href="http://libvirt.org/">libvirt</a></dt>
        <dd><span>The open source virtualization API</span></dd>
<!--        <dt><a href="http://thincrust.et.redhat.com/">Thin Crust</a></dt>
        <dd><span>Tools for building virtual appliances</span></dd>-->
      </dl>
      <dl id="p2">
        <dt><a href="http://cobbler.et.redhat.com/">Cobbler</a></dt>
        <dd><span>OS provisioning and profile management</span></dd>
        <dt><a href="http://ovirt.org/">oVirt</a></dt>
        <dd><span>Virtualization management across the data center</span></dd>
<!--        <dt><a href="http://et.redhat.com/~rjones/virt-p2v/">p-2-v</a></dt>
        <dd><span>Virtualize existing deployed servers</span></dd>-->
      </dl>
      <dl id="p3">
        <dt><a href="http://freeipa.org/">FreeIPA</a></dt>
        <dd><span>Identity, policy and audit management</span></dd>
        <dt><a href="http://virt-manager.org/">Virtual Machine Manager</a></dt>
        <dd><span>Virtualization management from the desktop</span></dd>
<!--        <dt><a href="http://virt-manager.org/">Virtual Tools</a></dt>
        <dd><span>Virtualization management from the command line</span></dd>-->
      </dl>
    </div>
    <p id="et">
      <a href="http://et.redhat.com/"><img src="../styles/et_logo.png" alt="A Red Hat Emerging Technology Project"></a>
    </p>
  </div>
</body>
</html>
